!function(e){function r(r){if(e(r).parent().hasClass("cf_wrapper"))return!0;var a,t=e.Deferred(),i=e.Deferred(),d=e.Deferred(),r=e(r),p=e(r).clone(),u=r.attr("id"),v=new RegExp(r.attr("id")+"$","g");return r.wrap('<div class="cf_wrapper" id="'+u+'_wrapper"></div>').addClass("show").addClass("video_1"),a=e(".cf_wrapper#"+u+"_wrapper"),a.append('<div class="cf_overlay"></div>'),p.attr("id",u+"_2").addClass("video_2").attr("src",p.attr("src").replace(v,u+"_2")),a.append(p),n.players[r.attr("id")]=[],$f(r[0]).addEvent("ready",function(i){n.players[r.attr("id")][0]=$f(i),t.resolve(),$f(i).addEvent("playProgress",function(r){var t=a.data("vars");t.switch_video&&0==t.current_video&&(a.data("vars").switch_video=!1,a.data("vars").timeout=!0,e(".video_2",a).removeClass("show"),e(".video_1",a).addClass("show"),setTimeout(function(){$f(p[0]).api("pause"),a.data("vars").timeout=!1},t.duration)),0==t.current_video&&s.playProgress(r)})}),$f(p[0]).addEvent("ready",function(t){n.players[r.attr("id")][1]=$f(t),i.resolve(),$f(p[0]).api("setVolume",0).api("play").api("pause"),$f(t).addEvent("playProgress",function(t){var i=a.data("vars");i.switch_video&&1==i.current_video&&(a.data("vars").timeout=!0,a.data("vars").switch_video=!1,e(".video_1",a).removeClass("show"),e(".video_2",a).addClass("show"),setTimeout(function(){$f(r[0]).api("pause"),a.data("vars").timeout=!1},i.duration)),1==i.current_video&&s.playProgress(t)})}),e.when(t,i).done(function(){a.data("vars",o),d.resolve()}),d}function a(r,a){var o=e(".cf_wrapper#"+r+"_wrapper").data("vars");if(!a.seconds)return!1;if(o.timeout)return!1;a.duration&&i(o,a.duration);var s=a.ignore_gap?a.ignore_gap:o.ignore_gap;n.players[r][o.current_video].api("getCurrentTime",function(e){e=Math.round(e);var i=a.seconds-e;(i>s||0>i)&&(o.switch_video=!0,t(n.players[r][o.current_video],o.duration),o.current_video=0==o.current_video?1:0,t(n.players[r][o.current_video],o.duration,!0),n.players[r][o.current_video].api("seekTo",a.seconds),n.players[r][o.current_video].api("play"))})}function t(e,r,a){var t=a?.1:-.1,i=1,o=10,n=a?0:1,s=setInterval(function(){e.api("setVolume",n+i*t),i++,i>10&&clearInterval(s)},r/o)}function i(r,a){r.duration=a;var t={"-webkit-transition":"opacity "+a+"ms ease-in-out","-moz-transition":"opacity "+a+"ms ease-in-out",transition:"opacity "+a+"ms ease-in-out"};e(".cf_wrapper iframe").css(t)}var o={current_video:0,switch_video:!1,timeout:!1,ignore_gap:5,duration:150},n={players:[]},s={init:function(a){var t=[];return e.extend(o,a),e(this).each(function(){var a=new e.Deferred;r(e(this)[0]).done(function(){a.resolve()}),t.push(a)}),e.when.apply(void 0,t).promise()},elm:function(){var r=e(e(this)[0]).attr("id"),a=e(".cf_wrapper#"+r+"_wrapper").data("vars");return n.players[r][a.current_video]},fadeTo:function(r){var t=e(e(this)[0]).attr("id");return a(t,r)},onPlayProgess:function(e){s.playProgress=e},playProgress:function(){}};e.fn.crossfader=function(r){return"undefined"==typeof $f&&e.error("Crossfader needs Froogaloop"),s[r]?s[r].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof r&&r?void e.error("Method "+r+" does not exist"):s.init.apply(this,arguments)}}(jQuery);